on: [push, pull_request]
jobs:
  install_symfony:
    runs-on: ubuntu-latest
    services:
      mysql:
        image: mysql:8.0
        env:
          MYSQL_ROOT_PASSWORD: 'th3p@tform'
          MYSQL_DATABASE: 'the_platform'
        ports:
          - 8888:3306
        options: --health-cmd="mysqladmin ping" --health-interval=10s --health-timeout=5s --health-retries=3
    strategy:
      fail-fast: true
      matrix:
        php-version: ['8.1']

    steps:
      - name: checkout
        uses: actions/checkout@v3

      - name: Set up php the project
        uses: shivammathur/setup-php@verbose
        with:
          php-version: ${{ matrix.php-version }}
          extensions: mbstring, mysql, xml, ctype, intl, iconv, filter, gd, json, pdo

      - name: install packages
        run: composer install --no-progress --no-suggest --prefer-dist

      - name: Checking symfony installation
        run: php bin/console about

      - name: Config db
        run: php bin/console d:d:c
